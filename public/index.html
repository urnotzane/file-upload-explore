<html>
  <head> </head>
  <body>
    <form
      action="/upload"
      method="POST"
      name="form"
      enctype="multipart/form-data"
    >
      <input
        onchange="handleChange(this)"
        type="file"
        name="file1"
        value="请选择文件"
        multiple="multiple"
      /><br />
      <input type="submit" />
    </form>

    <input
      id="input"
      onchange="handleChange(this)"
      type="file"
      name="file2"
      value="请选择文件"
    /><br />
    <button onclick="onSubmit()">提交</button>
    <script>
      function handleChange(e) {
        const form = document.querySelectorAll("form[name=form]");
        console.log(form);
      }
      function onSubmit() {
        const file = document.getElementById("input").files[0];
        console.log(file);
        const fd = new FormData();
        fd.append("file", file);
        postFile(fd);
        putFile(file);
      }
      // formData上传
      function postFile(fd) {
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "/upload", true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            alert(xhr.responseText);
          }
        };
        console.log(fd);

        xhr.send(fd);
      }
      // request body上传
      function putFile(body) {
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "/upload", true);
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4 && xhr.status == 200) {
            alert(xhr.responseText);
          }
        };
        xhr.send(body);
      }
    </script>
  </body>
</html>
